<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>shop-car</title>
    <link rel="stylesheet" href="../css/shop-car.css">

    <link rel="stylesheet" href="../../font/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../font/font-awesome-4.7.0/less/variables.less">
</head>
<body>
<div id="header">
    <img src="../image/05.jpg" alt="logo">
</div>
<div id="nav">您的位置：
    <a href="#">首页</a>&gt;
    <a href="#">我的淘宝</a>&gt;我的购物车
</div>
<div id="navlist">
    <ul>
        <li class="navlist_red_left"></li>
        <li class="navlist_red">1.查看购物车</li>
        <li class="navlist_red_arrow"></li>
        <li class="navlist_gray">2.确定订单信息</li>
        <li class="navlist_gray_arrow"></li>
        <li class="navlist_gray">3.付款到支付宝</li>
        <li class="navlist_gray_arrow"></li>
        <li class="navlist_gray">4.确定收货</li>
        <li class="navlist_gray_arrow"></li>
        <li class="navlist_gray">5.评价</li>
        <li class="navlist_gray_right"></li>
    </ul>
</div>

<div id="content">
    <form action="" method="post" name="myform">
        <table width="100%" border="0" cellpadding="0" cellspacing="0" id="shopping">
            <tr>
                <td class="title_1"><input id="allCheckBok" type="checkbox" value="">全选</td>
                <td class="title_2" colspan="2">店铺宝贝</td>
                <td class="title_3">获积分</td>
                <td class="title_4">单价（元）</td>
                <td class="title_5">数量</td>
                <td class="title_6">小计（元）</td>
                <td class="title_7">操作</td>
            </tr>

            <tr>
                <td colspan="8" class="line"></td>
            </tr>

            <tr>
                <td colspan="8" class="shopInfo">店铺：
                    <a href="#">纤巧百媚时尚鞋坊</a> 卖家：
                    <a href="#">纤巧百媚</a>
                    <img src="../image/06.jpg">
                </td>
            </tr>
            <tr id="product1">
                <td class="td_1">
                    <input type="checkbox" name="cartCheckBox" value="product1">
                </td>
                <td class="td_2">
                    <img src="../image/01.jpg" alt="shopping"/>
                </td>
                <td class="td_3">
                    <a href="#">日韩流行风时尚美眉最爱独特米字拼图金属坡跟公主靴子黑色</a>
                    <br/> 颜色：棕色 尺码：37<br /> 保障：
                    <img src="../image/02.jpg"/>
                </td>
                <td class="td_4">5</td>
                <td class="td_5">138.00</td>
                <td class="td_6">
                    <img src="img/taobao_minus.jpg" alt="minus" class="hand">
                    <input type="text" id="num_1" value="1" class="num_input" readonly="readonly">
                    <img src="img/taobao_adding.jpg" alt="add" class="hand" />
                </td>
                <td class="td_7"></td>
                <td class="td_8">
                    <a href="javascript:void(0):">删除</a>
                </td>
            </tr>

            <tr>
                <td colspan="8" class="shopInfo">店铺：
                    <a href="#">香港我的美丽日记</a> 卖家：
                    <a href="#">lokemick2009</a>
                    <img src="../image/03.jpg" alt="relation" />
                </td>
            </tr>

            <tr id="product2">
                <td class="td_1">
                    <input name="cartCheckBox" type="checkbox" value="product2" />
                </td>
                <td class="td_2">
                    <img src="../image/04.jpg" alt="shopping" />
                </td>
                <td class="td_3">
                    <a href="#">chanel/香奈尔/香奈尔炫亮魅力唇膏3.5g</a><br/> 保障：
                    <img src="img/taobao_icon_01.jpg" alt="icon" />
                    <img src="img/taobao_icon_02.jpg" alt="icon" /></td>
                <td class="td_4">12</td>
                <td class="td_5">265.00</td>
                <td class="td_6">
                    <img src="img/taobao_minus.jpg" alt="minus" class="hand" />
                    <input id="num_2" type="text" value="1" class="num_input" readonly="readonly" />
                    <img src="img/taobao_adding.jpg" alt="add" class="hand" /></td>
                <td class="td_7"></td>
                <td class="td_8">
                    <a href="javascript:void(0);">删除</a>
                </td>
            </tr>

            <tr>
                <td colspan="8" class="shopInfo">店铺：
                    <a href="#">实体经营</a> 卖家：
                    <a href="#">林颜店铺</a> <img src="img/taobao_relation.jpg" alt="relation" /></td>
            </tr>
            <tr id="product3">
                <td class="td_1"><input name="cartCheckBox" type="checkbox" value="product3" /></td>
                <td class="td_2"><img src="img/taobao_cart_03.jpg" alt="shopping" /></td>
                <td class="td_3">
                    <a href="#">蝶妆海?蓝清滢粉底液10#（象牙白）</a><br /> 保障：
                    <img src="img/taobao_icon_01.jpg" alt="icon" /> <img src="img/taobao_icon_02.jpg" alt="icon" /></td>
                <td class="td_4">3</td>
                <td class="td_5">85.00</td>
                <td class="td_6"><img src="img/taobao_minus.jpg" alt="minus" class="hand" /> <input id="num_3" type="text" value="1" class="num_input" readonly="readonly" /> <img src="img/taobao_adding.jpg" alt="add" class="hand" /></td>
                <td class="td_7"></td>
                <td class="td_8">
                    <a href="javascript:void(0);">删除</a>
                </td>
            </tr>

            <tr>
                <td colspan="8" class="shopInfo">店铺：
                    <a href="#">红豆豆的小屋</a> 卖家：
                    <a href="#">taobao豆豆</a> <img src="img/taobao_relation.jpg" alt="relation" /></td>
            </tr>
            <tr id="product4">
                <td class="td_1"><input name="cartCheckBox" type="checkbox" value="product4" /></td>
                <td class="td_2"><img src="img/taobao_cart_04.jpg" alt="shopping" /></td>
                <td class="td_3">
                    <a href="#">相宜促销专供 大S推荐 最好用的LilyBell化妆棉</a><br /> 保障：
                    <img src="img/taobao_icon_01.jpg" alt="icon" /></td>
                <td class="td_4">12</td>
                <td class="td_5">12.00</td>
                <td class="td_6"><img src="img/taobao_minus.jpg" alt="minus" class="hand" /> <input id="num_4" type="text" value="2" class="num_input" readonly="readonly" /> <img src="img/taobao_adding.jpg" alt="add" class="hand" /></td>
                <td class="td_7"></td>
                <td class="td_8">
                    <a href="javascript:void(0);">删除</a>
                </td>
            </tr>

            <tr>
                <td colspan="3">
                    <a id="deleteAll" href="javascript:void(0)">
                        <img src="img/taobao_del.jpg" alt="删除所选" />
                    </a>
                </td>
                <td colspan="5" class="shopend">商品总价（不含运费）:
                    <label id="total" class="yellow"></label>元<br />
                    可获积分 <label class="yellow" id="integral"></label>点<br />
                    <input name="" type="image" src="img/taobao_subtn.jpg" alt="立刻购买"/></td>
            </tr>

        </table>

    </form>
</div>
</body>
<script src="../util/jquery.min.js"></script>
<script>
    $(function() {
        //点击复选框全选或不全选效果
        $("#allCheckBok").click(function() {
            var checked = $(this).is(":checked");
            $(".td_1").children().attr("checked", checked);
        });

        //判断是否全选
        function Allchk() {
            var checkedB = $(".td_1").children();
            var sum = checkedB.size();
            var k = 0;
            checkedB.each(function(index, dom) {
                if($(dom).is(":checked"))
                    k++;
            });

            if(k == sum) {
                $("#allCheckBok").attr("checked", true);
            } else {
                $("#allCheckBok").attr("checked", false)
            }

        }

        Allchk(); //页面加载完后运行

        //单选判断
        $(".td_1").children().click(function() {
            Allchk();
        })

        //计算总价与小计
        function prodC() {
            var $tr = $("#shopping").find("tr[id]");
            var summer = 0;
            var integral = 0;
            $tr.each(function(i, dom) {
                var num = $(dom).children(".td_6").find("input").val(); //商品数量
                var price = num * $(dom).children(".td_5").text(); //商品小计
                $(dom).children(".td_7").html(price); //显示商品小计
                summer += price; //总价
                integral += $(dom).children(".td_4").text() * num; //积分
            });
            $("#total").text(summer);
            $("#integral").text(integral);
        }
        prodC(); //页面加载完成后运行

        //商品增加减少 ，flag 为true时增加 flag为false时减少
        function changN(dom, flag) {
            var $input = $(dom).parent().find("input");
            var value = $input.val();
            if(flag) {
                value++;
            } else {
                value--;
                if(value < 0) {
                    value = 0;
                    alert("宝贝数量不能为负值")
                }
            }
            $input.val(value);
            prodC();
        };

        //点击增加
        $(".td_6").find("img[alt='minus']").click(function() {
            changN(this, false);
        });
        //点击减少
        $(".td_6").find("img[alt='add']").click(function() {
            changN(this, true);
        });

        //点击删除
        $(".td_8").find("a").click(function() {
            $(this).parent().parent().prev().remove(); //删除前一tr
            $(this).parent().parent().remove(); //删除当前tr
            prodC();
        });
        //点击删除所选
        $("#deleteAll").click(function() {
            $("#shopping").find("tr[id]").each(function(i, e) {
                var $tr = $(e);
                var checked = $tr.children(".td_1").children().is(":checked");
                if(checked) {
                    $tr.prev().remove();
                    $tr.remove();
                }
            });
            prodC()

        });

    })
</script>
</html>